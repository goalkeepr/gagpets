<!-- Generated by SpecStory -->

# Fixing compare mode functionality in pet weight input (2025-08-12 17:45Z)

_**User**_

When I click on "Compare Two Pets/Weights" the whole section to enter information disappears.

---

_**Assistant**_

I can see from the attachments that there's an issue with the "Compare two pets weight/ages" checkbox functionality. Let me examine the current HTML and JavaScript files to understand what's happening when this checkbox is clicked. I can see the issue! The problem is in the Compare mode toggle functionality. Looking at the HTML structure, I notice that when the "Compare two pets weight/ages" checkbox is checked, it's supposed to hide the single weight input section and show the comparison section, but it seems to be hiding too much.

Let me examine the CSS file to understand the styling: Now I understand the issue! Looking at the JavaScript code, I can see that the problem is in the `ModeSwitch.toggle()` function. When the compare mode is enabled, it's hiding the entire `singleWeightDiv` which contains both the weight inputs AND the age slider section, but it's not properly managing what should remain visible.

The problem is that when compare mode is enabled, it hides:
1. `singleWeightDiv` (which contains age, weight inputs AND the age slider)
2. `singleModifierInput` (the modifier dropdown)

But the age slider and some other input fields that users expect to see are inside the `singleWeightDiv`.

Let me examine the HTML structure more carefully to see exactly what elements are being hidden: Now I see the issue clearly. Let me look at what's inside the `singleWeightInput` div: Perfect! Now I can see the exact problem. The `singleWeightInput` div contains:
1. Pet Age input
2. Pet Weight input  
3. Age Slider

When compare mode is enabled, this entire div gets hidden, which means users lose access to ALL of these input fields. But looking at the compare mode section, I can see it has its own age inputs for both pets, so the issue is that when you enable compare mode, you're hiding the form inputs that should still be accessible.

Looking at the attachments, I can see that when "Compare two pets weight/ages" is checked, it should show a different set of inputs for entering two different weights and ages, but it shouldn't hide the entire input section.

Let me fix this by modifying the ModeSwitch.toggle() function to properly manage which elements are shown/hidden: 
```

```
Wait, I think I misunderstood the issue. Looking at the attachments more carefully, I can see that the user expects to see input fields when "Compare two pets weight/ages" is checked, but the whole section disappears. This suggests that the `compareWeightInputs` div should be showing when compare mode is enabled, but it's not.

Let me check if there might be a problem with the element ID references in the DOMManager: I notice there's an inconsistency. In the DOMManager.init(), there's:

```javascript
compareWeightDiv: document.getElementById('compareWeightInputs'),
```

But in the toggle function, it's accessing:
```javascript
const compareWeightDiv = DOMManager.getElement('compareWeightInputs');
```

However, in the DOMManager, the key should be `compareWeightDiv`, not `compareWeightInputs`. Let me check the DOMManager initialization: I can see the problem! In the DOMManager, the key is correctly defined as `compareWeightDiv`, but in the ModeSwitch.toggle() function, it's calling `DOMManager.getElement('compareWeightInputs')` (with an 's' at the end) instead of `DOMManager.getElement('compareWeightDiv')`.

Let me fix this: 
```

```
Now let me test the fix by opening the `pets.html` file in a browser to verify that the compare mode works correctly: Perfect! I've identified and fixed the issue. The problem was in the `ModeSwitch.toggle()` function where it was trying to access the wrong element key in the DOMManager.

**The Issue:**
- The DOMManager stored the element with the key `compareWeightDiv` 
- But the toggle function was calling `DOMManager.getElement('compareWeightInputs')` (note the extra 's')
- This meant the function was getting `null` instead of the actual DOM element
- When `DOMManager.toggleElement()` was called with `null`, nothing happened, so the compare inputs never showed

**The Fix:**
I changed line where the `compareWeightDiv` is retrieved from:
```javascript
const compareWeightDiv = DOMManager.getElement('compareWeightInputs');
```
to:
```javascript
const compareWeightDiv = DOMManager.getElement('compareWeightDiv');
```

Now when you click the "Compare two pets weight/ages" checkbox, it should properly:
1. Hide the single weight input section
2. Show the comparison input section with fields for two different pets' weights and ages
3. Hide the single modifier input and show the comparison modifier inputs

The interface should now work as expected - when you check the compare box, you'll see input fields for Pet 1 Weight, Pet 2 Weight, Pet 1 Age, Pet 2 Age, and mutation options for both pets.

---

